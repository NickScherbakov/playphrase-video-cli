# PlayPhrase 2025 üåü

–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è –ø–æ–∏—Å–∫–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ –≤–∏–¥–µ–æ–∫–æ–Ω—Ç–µ–Ω—Ç—É. –ù–∞–π–¥–∏—Ç–µ –ª—é–±—É—é —Ñ—Ä–∞–∑—É –≤ —Å–≤–æ–∏—Ö —Ñ–∏–ª—å–º–∞—Ö –∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø–æ–ª—É—á–∏—Ç–µ –≤–∏–¥–µ–æ–∫–ª–∏–ø.

## –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (v2.0)
- üé® **Modern UI:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ —Ç–µ–º–Ω–æ–π —Ç–µ–º–µ (Glassmorphism).
- ‚ö° **Async Core:** –ü–µ—Ä–µ–ø–∏—Å–∞–Ω–Ω—ã–π –Ω–∞ `aiosqlite` –±—ç–∫–µ–Ω–¥ –¥–ª—è –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
- üé¨ **Clip Download:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–∫–∞—á–∞—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π MP4 —Ñ–∞–π–ª.
- üé≤ **Random Mode:** –ö–Ω–æ–ø–∫–∞ "–ú–Ω–µ –ø–æ–≤–µ–∑–µ—Ç" –¥–ª—è —Å–ª—É—á–∞–π–Ω—ã—Ö —Ü–∏—Ç–∞—Ç.
- ‚å®Ô∏è **Keyboard Shortcuts:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–µ–ª–∫–∞–º–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º.

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- Python 3.10+ (–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ Python 3.14)
- ffmpeg (—Å–º. [FFMPEG_SETUP.md](FFMPEG_SETUP.md) –¥–ª—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ)
- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏: FastAPI, Uvicorn, Pydantic v2

## –°—É–ø–µ—Ä-–ø—Ä–æ—Å—Ç–æ–π –∑–∞–ø—É—Å–∫ (–º–∏–Ω–∏–º—É–º –¥–µ–π—Å—Ç–≤–∏–π)

1. –°–ª–æ–∂–∏—Ç–µ —Å–≤–æ–∏ –ø–∞—Ä—ã `film.mp4` + `film.srt` –≤ –ø–∞–ø–∫—É `media` (—Å–æ–∑–¥–∞–π—Ç–µ –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç).
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–¥–∏–Ω —Ñ–∞–π–ª:
```powershell
python run_app.py
```
   –°–∫—Ä–∏–ø—Ç —Å–∞–º:
   - —Å–æ–∑–¥–∞—Å—Ç –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–∞–ø–∫—É `media/`;
   - —Å–æ–∑–¥–∞—Å—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª —Å—É–±—Ç–∏—Ç—Ä–æ–≤ `media/demo.srt`;
   - –ø–æ—Å—Ç—Ä–æ–∏—Ç/–æ–±–Ω–æ–≤–∏—Ç –±–∞–∑—É `subtitles.db`;
   - –∑–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–µ—Ä FastAPI –Ω–∞ `http://127.0.0.1:8000/`.
3. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `http://127.0.0.1:8000/`
4. –ù–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –º–æ–∂–Ω–æ:
	- –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏–¥–µ–æ –∏/–∏–ª–∏ —Å—É–±—Ç–∏—Ç—Ä —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É (–∫–Ω–æ–ø–∫–∞ **Upload**);
	- –ø–µ—Ä–µ—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω–¥–µ–∫—Å (–∫–Ω–æ–ø–∫–∞ **Reindex**);
	- –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ–∏—Å–∫ —Ñ—Ä–∞–∑ –±–µ–∑ –∫–æ–º–∞–Ω–¥ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ.

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```powershell
python -m venv .venv
.\.venv\Scripts\Activate.ps1
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```powershell
pip install -r requirements.txt
```

## –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—É—Å—Ç–∞—è –ë–î –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```powershell
python init_empty_db.py
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò–º–ø–æ—Ä—Ç —Å—É–±—Ç–∏—Ç—Ä–æ–≤ –∏–∑ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ –≤—Ä—É—á–Ω—É—é
```powershell
python build_subtitles_db.py path/to/media/root --db subtitles.db
```

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –º–µ–¥–∏–∞-–∫–∞—Ç–∞–ª–æ–≥–∞:**
- –ö–∞–∂–¥—ã–π –≤–∏–¥–µ–æ—Ñ–∞–π–ª (`.mp4` –∏–ª–∏ `.mkv`) –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª —Å—É–±—Ç–∏—Ç—Ä–æ–≤ (`.srt`) —Å —Ç–µ–º –∂–µ –∏–º–µ–Ω–µ–º
- –ü—Ä–∏–º–µ—Ä: `movie.mp4` + `movie.srt`
- –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥—ë—Ç –ø–∞—Ä—ã —Ñ–∞–π–ª–æ–≤ –∏ –ø–æ—Å—Ç—Ä–æ–∏—Ç –∏–Ω–¥–µ–∫—Å FTS5.
- –ß–µ—Ä–µ–∑ –≤–µ–±-—Ñ–æ—Ä–º—É –∑–∞–≥—Ä—É–∑–∫–∏: –µ—Å–ª–∏ –∏–º–µ–Ω–∞ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç, —Å—É–±—Ç–∏—Ç—Ä –±—É–¥–µ—Ç –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω –ø–æ–¥ –≤–∏–¥–µ–æ.

## –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–± ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `run_app.py` (—Å–º. –≤—ã—à–µ). –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–µ—Ä–≤–µ—Ä –≤—Ä—É—á–Ω—É—é:

```powershell
.\.venv\Scripts\python.exe -m uvicorn app:app --host 127.0.0.1 --port 8000
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ (–µ—Å–ª–∏ venv –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω):**
```powershell
python -m uvicorn app:app --host 127.0.0.1 --port 8000
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: `http://127.0.0.1:8000`
2. –í–≤–µ–¥–∏—Ç–µ —Ñ—Ä–∞–∑—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: "I'll be back") –∏ –Ω–∞–∂–º–∏—Ç–µ **Search**.
3. –ü–µ—Ä–≤—ã–π –Ω–∞–π–¥–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è –≤–Ω–∏–∑—É, –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä –ø–µ—Ä–µ–º–æ—Ç–∞–µ—Ç—Å—è –∫ –Ω—É–∂–Ω–æ–º—É –º–µ—Å—Ç—É –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞.
4. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–∞–∂–º–∏—Ç–µ –∑–µ–ª—ë–Ω—É—é –∫–Ω–æ–ø–∫—É **"–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏"** –ø–æ–¥ –ø–ª–µ–µ—Ä–æ–º.
5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ **Prev/Next** –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏.
6. –î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∏—Ö —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É **Upload** –∏–ª–∏ –ø–æ–ª–æ–∂–∏—Ç–µ –≤ –ø–∞–ø–∫—É `media/` –∏ –Ω–∞–∂–º–∏—Ç–µ **Reindex** –¥–ª—è –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∏.

## API Endpoints

- `GET /` ‚Äî –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (`index.html`).
- `GET /search?q=phrase&limit=25` ‚Äî –ø–æ–∏—Å–∫ –ø–æ —Å—É–±—Ç–∏—Ç—Ä–∞–º (JSON).
- `GET /media/{filename}` ‚Äî —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–¥–∞—á–∞ –≤–∏–¥–µ–æ—Ñ–∞–π–ª–∞; –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–±‚Äë–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è —Å —Ç–æ—á–Ω–æ–π –ø–µ—Ä–µ–º–æ—Ç–∫–æ–π –ø–æ `currentTime`.
- `POST /upload` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ –∏/–∏–ª–∏ —Å—É–±—Ç–∏—Ç—Ä–æ–≤; –≤ –æ—Ç–≤–µ—Ç–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—É—Ç—å –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π.
- `POST /reindex` ‚Äî –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤—Å–µ—Ö `.srt` –≤ –ø–∞–ø–∫–µ `media/`.
- `GET /stream/{subtitle_id}` ‚Äî **deprecated**: —Å—Ç–∞—Ä—ã–π FFmpeg‚Äë—Å—Ç—Ä–∏–º–∏–Ω–≥ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∫–ª–∏–ø–∞.
- `GET /stream/{subtitle_id}?reencode=true` ‚Äî **deprecated**: —Å—Ç—Ä–∏–º–∏–Ω–≥ —Å –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ–º (–æ—Å—Ç–∞–≤–ª–µ–Ω –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤).

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

- **FTS5 –ø–æ–∏—Å–∫:** –¥–ª—è —Ñ—Ä–∞–∑ —Å –ø—Ä–æ–±–µ–ª–∞–º–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–∞–≤—ã—á–∫–∏ –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
- **Fallback –Ω–∞ LIKE:** –µ—Å–ª–∏ FTS5 –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è LIKE-–∑–∞–ø—Ä–æ—Å
- **FFmpeg:** –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–º `/stream/{id}` –¥–ª—è –Ω–∞—Ä–µ–∑–∫–∏ –∫–ª–∏–ø–æ–≤, –Ω–æ —Ç–µ–∫—É—â–∏–π UI –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –∏—Å—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ `/media` –±–µ–∑ –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
playphrase/
‚îú‚îÄ‚îÄ app.py                  # FastAPI backend
‚îú‚îÄ‚îÄ build_subtitles_db.py   # –°–∫—Ä–∏–ø—Ç –∏–º–ø–æ—Ä—Ç–∞ —Å—É–±—Ç–∏—Ç—Ä–æ–≤
‚îú‚îÄ‚îÄ init_empty_db.py        # –°–æ–∑–¥–∞–Ω–∏–µ –ø—É—Å—Ç–æ–π –ë–î (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îú‚îÄ‚îÄ index.html              # –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îú‚îÄ‚îÄ requirements.txt        # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ subtitles.db           # SQLite –±–∞–∑–∞ (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îî‚îÄ‚îÄ README.md              # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### ffmpeg –Ω–µ –Ω–∞–π–¥–µ–Ω
–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ [FFMPEG_SETUP.md](FFMPEG_SETUP.md) –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ FFmpeg.
–ó–∞—Ç–µ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ ffmpeg –¥–æ—Å—Ç—É–ø–µ–Ω:
```powershell
ffmpeg -version
```

### –°–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Python –∏–∑ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```powershell
.\.venv\Scripts\python.exe --version
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞
–ó–∞–ø—É—Å—Ç–∏—Ç–µ `build_subtitles_db.py` —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º –ø—É—Ç—ë–º –∫ –º–µ–¥–∏–∞-—Ñ–∞–π–ª–∞–º.
